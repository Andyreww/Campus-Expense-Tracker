<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="logo.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nooksii - Login</title>
    
    <!-- Prevent caching of auth state -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- External Stylesheets -->
    <link rel="stylesheet" href="login.css">
    
    <!-- Google Fonts (Cafe Vibe) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Nunito:wght@700;900&family=Patrick+Hand&display=swap" rel="stylesheet">

</head>
<body>

    <main class="login-container">
        <div class="login-clipboard">
            <div class="clip"></div>
            <div class="paper">
                <a href="index.html" class="back-link" onclick="window.location.replace('index.html'); return false;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                    <span>Back to Nook</span>
                </a>
                <h1 id="form-title" class="login-title">Grab a Seat</h1>
                <p id="form-subtitle" class="login-subtitle">It's all here, waiting for you</p>

                <!-- The data-mode attribute will be used by CSS to show/hide elements -->
                <form id="auth-form" class="auth-form" data-mode="login">
                    <div>
                        <label for="email" class="form-label">Email Address</label>
                        <input type="email" id="email" placeholder="you@school.edu" class="form-input" required>
                    </div>
                    <div>
                        <label for="password" class="form-label">Password</label>
                        <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" class="form-input" required>
                    </div>

                    <!-- TOS Agreement Checkbox for sign-up mode -->
                    <div class="tos-agreement-group">
                        <input type="checkbox" id="tos-checkbox" name="tos">
                        <label for="tos-checkbox">I have read and agree to the <a href="#" id="tos-link">Terms of Service</a>.</label>
                    </div>

                    <div id="auth-error" class="auth-error-message hidden"></div>

                    <div class="button-group">
                        <!-- These buttons have the original IDs so auth.js can find them -->
                        <button type="submit" id="sign-in-button" class="auth-button">Sign In</button>
                        <button type="button" id="create-account-button" class="auth-button secondary-button">Create Account</button>
                    </div>
                </form>

                <div class="separator">or</div>

                <button type="button" id="google-signin-button" class="google-button">
                    <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path fill="#FFC107" d="M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"/><path fill="#FF3D00" d="M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z"/><path fill="#4CAF50" d="M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.202 0-9.619-3.317-11.283-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z"/><path fill="#1976D2" d="M43.611 20.083H42V20H24v8h11.303c-.792 2.237-2.19 4.212-4.048 5.574l6.19 5.238C39.999 35.591 44 29.891 44 24c0-1.341-.138-2.65-.389-3.917z"/></svg>
                    Continue with Google
                </button>
            </div>
        </div>
    </main>

    <!-- TOS Modal -->
    <div id="tos-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-modal-button" class="modal-close-button">&times;</button>
            <div class="tos-text">
                <h2>ğŸŒ¿ Nooksii Terms of Service</h2>
                <p class="updated-date">Updated: August 5, 2025</p>

                <h3>Hey! Welcome to Nooksii ğŸ’›</h3>
                <p>This app was made with one goal: to help students keep track of their campus spending in a simple, cozy, stress free way. Weâ€™re not here to profit off your info, and we really donâ€™t care about collecting data on you. Promise.</p>

                <h3>ğŸ§  What is Nooksii?</h3>
                <p>Nooksii is a little app built by students, for students. It helps you:</p>
                <ul>
                    <li>track how much money youâ€™ve spent (or have left) on campus</li>
                    <li>log little purchases like coffees and snacks</li>
                    <li>see your spending habits and plan better</li>
                </ul>
                <p>Thatâ€™s it! No ads, no selling stuff, no hidden charges. Just helpful vibes.</p>

                <h3>ğŸ” What Info We Collect (And What We Donâ€™t)</h3>
                <p>We keep it minimal:</p>
                <ul>
                    <li>your email and username, so your account can exist</li>
                    <li>your spending balance and logged items, so your info shows up when you log in</li>
                </ul>
                <p>What we donâ€™t do:</p>
                <ul>
                    <li>âŒ we donâ€™t sell your data</li>
                    <li>âŒ we donâ€™t track your behavior</li>
                    <li>âŒ we donâ€™t care about your habits beyond helping you</li>
                    <li>âŒ weâ€™re not sending anything to 3rd parties, advertisers, or any creepy data people</li>
                </ul>
                <p>Your data stays between you and Nooksii, and honestlyâ€¦ we donâ€™t even wanna look at it unless we have to fix a bug or help you out.</p>

                <h3>ğŸ’« Deleting Your Account</h3>
                <p>Donâ€™t wanna use Nooksii anymore? Thatâ€™s totally okay. You can delete your account any time in the dashboard. It will remove everything related to you from our system. No drama, no weird â€œplease stay!â€ popups. Just poof... itâ€™s gone.</p>

                <h3>ğŸš« What Not to Do</h3>
                <p>Weâ€™re a small team (likeâ€¦ one person lol :3), so we ask that you please:</p>
                <ul>
                    <li>donâ€™t try to break or hack the site</li>
                    <li>donâ€™t spam or troll</li>
                    <li>donâ€™t pretend to be someone else</li>
                    <li>donâ€™t use it for anything other than good, helpful reasons</li>
                    <li>don't use anything NSFW or else you will be banned forever (no appeals)</li>
                </ul>
                <p>Basically: be a good human and respect the space ğŸŒ±</p>

                <h3>âš ï¸ No Promises, Just Vibes</h3>
                <p>This is a personal project. Itâ€™s not backed by a big company. That means:</p>
                <ul>
                    <li>things might go down sometimes</li>
                    <li>bugs can happen</li>
                    <li>we canâ€™t guarantee perfection</li>
                    <li>weâ€™re not liable if something glitches or your balance looks off</li>
                </ul>
                <p>That said, I do our best to keep it stable and helpful. If something breaks, and I'll try to fix it fast.</p>

                <h3>ğŸ“Œ Updates to These Terms</h3>
                <p>If we ever change how Nooksii works or update our policies, weâ€™ll let you know ahead of time. Nothing shady, no surprise changes. Youâ€™ll always be in the loop.</p>

                <h3>ğŸ’Œ Got Questions?</h3>
                <p>I'm just an alumni trying to make a helpful tool that I would've appreciated when I was in university. If you ever have questions, issues, or just wanna say hi, email us at: ajangulo8@gmail.com</p>
                <p>I will get back to you as soon as we can! But pls dont spam me ;-;</p>

                <h3>âœ… By using Nooksiiâ€¦</h3>
                <p>Youâ€™re saying â€œcool, Iâ€™m down with these vibesâ€ and you agree to everything above. Thatâ€™s it!</p>
                <p>I hope you enjoy Nooksii I really poured my heart into it!</p>
            </div>
        </div>
    </div>

    <!-- This script handles UI toggling and should not conflict with auth.js -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const authForm = document.getElementById('auth-form');
            const formTitle = document.getElementById('form-title');
            const formSubtitle = document.getElementById('form-subtitle');
            const signInButton = document.getElementById('sign-in-button');
            const createAccountButton = document.getElementById('create-account-button');
            const tosCheckbox = document.getElementById('tos-checkbox');
            const authError = document.getElementById('auth-error');

            const tosModal = document.getElementById('tos-modal');
            const tosLink = document.getElementById('tos-link');
            const closeModalButton = document.getElementById('close-modal-button');

            const setMode = (mode) => {
                authForm.dataset.mode = mode;
                authError.classList.add('hidden'); // Hide errors on mode switch

                if (mode === 'signup') {
                    formTitle.textContent = 'Create an Account';
                    formSubtitle.textContent = 'Let\'s get you set up.';
                    createAccountButton.textContent = 'Confirm & Create Account';
                    signInButton.textContent = 'Back to Sign In';
                    // Change the sign-in button to a 'button' type so it doesn't submit the form
                    signInButton.type = 'button'; 
                } else { // mode === 'login'
                    formTitle.textContent = 'Grab a Seat';
                    formSubtitle.textContent = 'It\'s all here, waiting for you.';
                    createAccountButton.textContent = 'Create Account';
                    signInButton.textContent = 'Sign In';
                    // Restore the sign-in button to a 'submit' type
                    signInButton.type = 'submit';
                }
            };

            // This listener handles the "Create Account" / "Confirm" button
            createAccountButton.addEventListener('click', (e) => {
                if (authForm.dataset.mode === 'login') {
                    // If in login mode, switch to signup mode.
                    // This click should NOT bubble up to auth.js
                    e.stopImmediatePropagation();
                    setMode('signup');
                } else {
                    // If in signup mode, check the TOS box.
                    // If unchecked, block the click from reaching auth.js
                    if (!tosCheckbox.checked) {
                        e.stopImmediatePropagation();
                        authError.textContent = 'Please agree to the Terms of Service.';
                        authError.classList.remove('hidden');
                    }
                    // If the box IS checked, this listener does nothing,
                    // allowing the click event to be handled by auth.js
                }
            });

            // This listener handles the "Sign In" / "Back to Sign In" button
            signInButton.addEventListener('click', (e) => {
                if (authForm.dataset.mode === 'signup') {
                    // If in signup mode, this is a "Back" button.
                    // It should not submit the form.
                    e.preventDefault();
                    setMode('login');
                }
                // If in login mode, this is a normal submit button and does its thing.
            });

            // Modal display logic
            tosLink.addEventListener('click', (e) => {
                e.preventDefault();
                tosModal.classList.remove('hidden');
            });

            closeModalButton.addEventListener('click', () => {
                tosModal.classList.add('hidden');
            });

            tosModal.addEventListener('click', (e) => {
                if (e.target === tosModal) {
                    tosModal.classList.add('hidden');
                }
            });
        });
    </script>
    <script type="module" src="auth.js"></script>
</body>
</html>
