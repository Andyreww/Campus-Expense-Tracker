<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nooksii - Login</title>
    
    <!-- Prevent caching of auth state -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- External Stylesheets -->
    <link rel="stylesheet" href="login.css">
    
    <!-- Google Fonts (Cafe Vibe) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Nunito:wght@700;900&family=Patrick+Hand&display=swap" rel="stylesheet">

</head>
<body>

    <main class="login-container">
        <div class="login-clipboard">
            <div class="clip"></div>
            <div class="paper">
                <a href="index.html" class="back-link" onclick="window.location.replace('index.html'); return false;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                    <span>Back to Nook</span>
                </a>
                <h1 id="form-title" class="login-title">Grab a Seat</h1>
                <p id="form-subtitle" class="login-subtitle">It's all here, waiting for you</p>

                <!-- Note: The button types are important for the original auth.js script -->
                <form id="auth-form" class="auth-form" data-mode="login">
                    <div>
                        <label for="email" class="form-label">Email Address</label>
                        <input type="email" id="email" placeholder="you@school.edu" class="form-input" required>
                    </div>
                    <div>
                        <label for="password" class="form-label">Password</label>
                        <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" class="form-input" required>
                    </div>

                    <!-- TOS Agreement Checkbox for sign-up mode -->
                    <div class="tos-agreement-group">
                        <input type="checkbox" id="tos-checkbox" name="tos">
                        <label for="tos-checkbox">I have read and agree to the <a href="#" id="tos-link">Terms of Service</a>.</label>
                    </div>

                    <div id="auth-error" class="auth-error-message hidden"></div>

                    <div class="button-group">
                        <!-- Sign in is a submit button -->
                        <button type="submit" id="sign-in-button" class="auth-button">Sign In</button>
                        <!-- Create account is a regular button -->
                        <button type="button" id="create-account-button" class="auth-button secondary-button">Create Account</button>
                    </div>
                </form>

                <div class="separator">or</div>

                <!-- Google sign in is a regular button -->
                <button type="button" id="google-signin-button" class="google-button">
                    <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path fill="#FFC107" d="M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"/><path fill="#FF3D00" d="M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z"/><path fill="#4CAF50" d="M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.202 0-9.619-3.317-11.283-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z"/><path fill="#1976D2" d="M43.611 20.083H42V20H24v8h11.303c-.792 2.237-2.19 4.212-4.048 5.574l6.19 5.238C39.999 35.591 44 29.891 44 24c0-1.341-.138-2.65-.389-3.917z"/></svg>
                    Continue with Google
                </button>
            </div>
        </div>
    </main>

    <!-- TOS Modal -->
    <div id="tos-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-modal-button" class="modal-close-button">&times;</button>
            <div class="tos-text">
                <h2>ğŸŒ¿ Nooksii Terms of Service</h2>
                <p class="updated-date">Updated: August 5, 2025</p>
                <!-- Full TOS text here... -->
                <h3>Hey! Welcome to Nooksii ğŸ’›</h3>
                <p>This app was made with one goal: to help students keep track of their campus spending in a simple, cozy, stress-free way. Weâ€™re not here to profit off your info, and we really donâ€™t care about collecting data on you. Promise.</p>
                <h3>ğŸ§  What is Nooksii?</h3>
                <p>Nooksii is a little app built by students, for students. It helps you:</p>
                <ul>
                    <li>track how much money youâ€™ve spent (or have left) on campus</li>
                    <li>log little purchases like coffees and snacks</li>
                    <li>see your spending habits and plan better</li>
                </ul>
                <p>Thatâ€™s it! No ads, no selling stuff, no hidden charges. Just helpful vibes.</p>
                <h3>ğŸ” What Info We Collect (And What We Donâ€™t)</h3>
                <p>We keep it minimal: your email and username, so your account can exist, and your spending balance and logged items â€” so your info shows up when you log in. What we donâ€™t do: we donâ€™t sell your data, we donâ€™t track your behavior, we donâ€™t care about your habits beyond helping you, and weâ€™re not sending anything to 3rd parties, advertisers, or any creepy data people. Your data stays between you and Nooksii, and honestlyâ€¦ we donâ€™t even wanna look at it unless we have to fix a bug or help you out.</p>
                <h3>ğŸ’« Deleting Your Account</h3>
                <p>Donâ€™t wanna use Nooksii anymore? Thatâ€™s totally okay. You can delete your account any time in your settings. Weâ€™ll remove everything related to you from our system. No drama, no weird â€œplease stay!â€ popups. Just poof â€” itâ€™s gone.</p>
                <h3>ğŸš« What Not to Do</h3>
                <p>Weâ€™re a small team, so we ask that you please: donâ€™t try to break or hack the site, donâ€™t spam or troll, donâ€™t pretend to be someone else, and donâ€™t use it for anything other than good, helpful reasons. Basically: be a good human and respect the space ğŸŒ±</p>
                <h3>âš ï¸ No Promises, Just Vibes</h3>
                <p>This is a personal project. Itâ€™s not backed by a big company. That means: things might go down sometimes, bugs can happen, we canâ€™t guarantee perfection, and weâ€™re not liable if something glitches or your balance looks off. That said â€” we do our best to keep it stable and helpful. If something breaks, weâ€™ll try to fix it fast.</p>
                <h3>ğŸ“Œ Updates to These Terms</h3>
                <p>If we ever change how Nooksii works or update our policies, weâ€™ll let you know ahead of time. Nothing shady, no surprise changes. Youâ€™ll always be in the loop.</p>
                <h3>ğŸ’Œ Got Questions?</h3>
                <p>Weâ€™re just students trying to make a helpful tool. If you ever have questions, issues, or just wanna say hi, email us at: [insert email/contact link]. Weâ€™ll get back to you as soon as we can (probably with a coffee in hand â˜•).</p>
                <h3>âœ… By using Nooksiiâ€¦</h3>
                <p>Youâ€™re saying â€œcool, Iâ€™m down with these vibesâ€ and you agree to everything above. Thatâ€™s it!</p>
            </div>
        </div>
    </div>

    <!-- This script handles UI toggling and should not conflict with auth.js -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const authForm = document.getElementById('auth-form');
            const signInButton = document.getElementById('sign-in-button');
            const createAccountButton = document.getElementById('create-account-button');
            const tosCheckbox = document.getElementById('tos-checkbox');
            const authError = document.getElementById('auth-error');

            const tosModal = document.getElementById('tos-modal');
            const tosLink = document.getElementById('tos-link');
            const closeModalButton = document.getElementById('close-modal-button');

            // This listener intercepts the click on the "Create Account" button
            createAccountButton.addEventListener('click', (e) => {
                // Check if we're in "signup" mode yet
                const isSignupMode = authForm.dataset.mode === 'signup';

                if (!isSignupMode) {
                    // If not in signup mode, switch to it and PREVENT the original click action
                    e.preventDefault();
                    e.stopImmediatePropagation(); // Stops auth.js from firing
                    
                    authForm.dataset.mode = 'signup';
                    document.getElementById('form-title').textContent = 'Create an Account';
                    document.getElementById('form-subtitle').textContent = 'Just one more step!';
                    
                    // Hide the original sign-in button and show the TOS agreement
                    signInButton.classList.add('hidden');
                    authForm.querySelector('.tos-agreement-group').style.display = 'flex';
                    
                    // Change this button's text to confirm
                    createAccountButton.textContent = 'Confirm & Create Account';

                } else {
                    // If we ARE in signup mode, check the checkbox
                    if (!tosCheckbox.checked) {
                        e.preventDefault(); // Stop submission
                        e.stopImmediatePropagation(); // Stop auth.js
                        authError.textContent = 'Please agree to the Terms of Service to continue.';
                        authError.classList.remove('hidden');
                    }
                    // If the box is checked, do nothing. The event will proceed to auth.js
                }
            });

            // Modal display logic
            tosLink.addEventListener('click', (e) => {
                e.preventDefault();
                tosModal.classList.remove('hidden');
            });

            closeModalButton.addEventListener('click', () => {
                tosModal.classList.add('hidden');
            });

            tosModal.addEventListener('click', (e) => {
                if (e.target === tosModal) {
                    tosModal.classList.add('hidden');
                }
            });
        });
    </script>
</body>
</html>
